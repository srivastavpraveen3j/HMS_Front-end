<div id="opd-sheet" class="opd-sheet" *ngIf="patientData?.length">
  <!-- Header -->
  <div class="header">
    <img src="P P Maniya_page-0001.jpg" alt="Logo" class="logo"  />
  </div>

  <!-- Title -->
  <h3 class="center-title text-center mt-3 mb-3"><u>TEST REPORT</u></h3>

  <!-- Patient Info -->
  <div class="info-grid d-flex justify-content-between mb-3">
    <div class="left-info">
      <!-- <p><strong>UHID NO:</strong> {{ matchedPatient?.uhid || 'N/A' }}</p> -->
      <p><strong>NAME:</strong> {{ patientData[0]?.walkInPatient?.name || 'N/A' }}</p>
      <p><strong>AGE / SEX:</strong>
        {{ patientData[0]?.walkInPatient?.age || 'N/A' }} /
        {{ patientData[0]?.walkInPatient?.gender }}
      </p>
      <p><strong>ADDRESS:</strong> {{ patientData[0]?.walkInPatient?.address || 'N/A' }}</p>
    </div>

    <div class="right-info text-right">
      <p><strong>DATE & TIME:</strong>
        {{ patientData[0]?.createdAt ? (patientData[0].createdAt | date: 'medium') : 'N/A' }}
      </p>
      <p><strong>PHONE NO.:</strong> {{ patientData[0]?.walkInPatient?.mobile_no || 'N/A' }}</p>
      <p><strong>Reference Doctor.:</strong> {{ patientData[0]?.walkInPatient?.referenceDoctor || 'Self' }}</p>
    </div>
  </div>

  <hr class="divider" />

  <!-- Test Group(s) -->
  <div *ngIf="patientData[0]?.testMaster?.length">
    <table class="table table-bordered w-100 text-center">
      <thead class="thead-light">
        <tr>
          <th class="text-left pl-2">Test</th>
          <th>Value</th>
          <th>Unit</th>
          <th>Reference Range</th>
        </tr>
      </thead>
    <tbody>
  <ng-container *ngFor="let group of patientData[0].testMaster">
    <tr>
      <td colspan="4" class="text-left font-weight-bold text-primary bg-light">
        <u>{{ group.testGroup || 'Test Group' }} Evaluation</u>
      </td>
    </tr>
    <tr *ngFor="let param of group.testParameters">
      <td class="text-left">{{ param.test_name }}</td>
      <td>{{ param.input }}</td>
      <td>{{ param.units }}</td>
      <td *ngIf="param.min && param.max">
        {{ param.min }} - {{ param.max }} {{ param.units }}
      </td>
      <td *ngIf="!param.min || !param.max">N/A</td>
    </tr>
  </ng-container>
</tbody>

    </table>
  </div>

  <!-- Findings -->
  <div class="mt-4">
    <h5><strong>Findings:</strong></h5>
    <p style="white-space: pre-wrap;">
      {{ patientData[0]?.remarks || 'N/A' }}
    </p>
  </div>
</div>

<!-- Footer -->
<hr />
<footer class="m-3 d-flex justify-content-between">
  <div style="visibility: hidden;">
    <div><input type="checkbox" /> Include Header</div>
    <div><input type="checkbox" /> Include Footer</div>
  </div>
  <button class="btn btn-dark" (click)="printOPDSheet()">Print <i class="fa-solid fa-print action-btn"></i></button>
</footer>
