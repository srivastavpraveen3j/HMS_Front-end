<div class="form-meta">
  <div class="header">
    <h2>ADD Vendor</h2>
    <div class="icons position-relative">
      <div class="btn-group">
        <button
          class="btn btn-outline-primary"
          [class.active]="uploadMode === 'single'"
          (click)="uploadMode = 'single'"
        >
          Single Entry
        </button>
        <button
          class="btn btn-outline-success"
          [class.active]="uploadMode === 'bulk'"
          (click)="uploadMode = 'bulk'"
        >
          Bulk Upload
        </button>
      </div>
      <i
        class="fa-solid fa-signal ms-3"
        [routerLink]="['/inventorylayout/vendorlist']"
        routerLinkActive="router-link-active"
      ></i>
    </div>
  </div>

  <!-- Only show if user has create permission -->
  <div *ngIf="userPermissions.create">
    <!-- Bulk Upload Mode -->
    <div *ngIf="uploadMode === 'bulk'" class="container mt-4">
      <label>Import Vendors in Bulk (CSV):</label>

      <div class="d-flex align-items-center gap-3 my-2">
        <h5 class="mb-0">Sample Vendor CSV File</h5>
        <a
          href="https://drive.google.com/file/d/1hu7uW2m1FK9JWR1sa42VOhwbna935PqG/view?usp=sharing"
          download
        >
          <i class="fa-solid fa-file-csv fs-4"></i>
        </a>
      </div>

      <input
        type="file"
        (change)="onFileSelected($event)"
        accept=".csv"
        class="form-control my-3"
      />

      <div class="text-center">
        <button
          class="btn btn-dark"
          (click)="uploadCSV()"
          [disabled]="!selectedFile"
        >
          Submit
        </button>
      </div>
    </div>

    <!-- Single Entry Mode -->
    <form
      *ngIf="uploadMode === 'single'"
      class="opd-container m-3"
      [formGroup]="vendorForm"
      (ngSubmit)="onSubmit()"
    >
      <div class="row">
        <!-- Left Half -->
        <div class="col-md-6">
          <div class="form-group mb-3">
            <label>Vendor Name*</label>
            <input
              type="text"
              class="form-control"
              formControlName="vendorName"
              placeholder="Vendor Name"
              required
            />
            <div
              *ngIf="
                vendorForm.get('vendorName')?.touched &&
                vendorForm.get('vendorName')?.invalid
              "
              class="text-danger"
            >
              Vendor Name is required
            </div>
          </div>

          <div class="form-group mb-3">
            <label>Contact Person</label>
            <input
              type="text"
              class="form-control"
              formControlName="contactPerson"
            />
          </div>

          <div class="form-group mb-3">
            <label>Mobile*</label>
            <input
              type="text"
              class="form-control"
              formControlName="phone"
              placeholder="10-digit mobile"
              maxlength="10"
              pattern="[6-9][0-9]{9}"
              title="Enter 10-digit mobile number starting with 6-9"
              (keypress)="allowOnlyNumbers($event)"
            />
            <div
              *ngIf="
                vendorForm.get('phone')?.touched &&
                vendorForm.get('phone')?.invalid
              "
              class="text-danger"
            >
              Enter valid 10-digit mobile number.
            </div>
          </div>
        </div>

        <!-- Right Half -->
        <div class="col-md-6">
          <div class="form-group mb-3">
            <label>Email</label>
            <input type="email" class="form-control" formControlName="email" />
            <div
              *ngIf="
                vendorForm.get('email')?.touched &&
                vendorForm.get('email')?.invalid
              "
              class="text-danger"
            >
              Please enter a valid email
            </div>
          </div>

          <div class="form-group mb-3">
            <label>GST Number</label>
            <input
              type="text"
              class="form-control"
              formControlName="gstNumber"
               maxlength="15"
            />
            <div
              *ngIf="
                vendorForm.get('gstNumber')?.touched &&
                vendorForm.get('gstNumber')?.errors
              "
            >
              <div
                class="text-danger"
                *ngIf="vendorForm.get('gstNumber')?.errors?.['required']"
              >
                GST Number is required
              </div>
              <div
                class="text-danger"
                *ngIf="vendorForm.get('gstNumber')?.errors?.['pattern']"
              >
                Enter a valid GST Number (15 characters : 22ABCDE1234F1Z5)
              </div>
            </div>
          </div>

          <div class="form-group mb-3">
            <label>Address</label>
            <input type="text" class="form-control" formControlName="address" />
          </div>
        </div>
      </div>

      <div class="text-center mt-3">
        <button
          class="btn btn-dark mx-2"
          type="submit"
          [disabled]="vendorForm.invalid"
        >
          Submit
        </button>
        <button
          class="btn btn-secondary"
          type="button"
          (click)="vendorForm.reset()"
        >
          Cancel
        </button>
      </div>
    </form>
  </div>
</div>
