<div class="form-meta">
  <div class="header">
    <h2>PACKAGE MASTER</h2>
    <span class="icons position-relative">
      <i
        class="fa-solid fa-signal"
        [routerLink]="['/master/packagemasterlist']"
        routerLinkActive="router-link-active"
      ></i>
    </span>
  </div>

  <div *ngIf="userPermissions.create">
    <form [formGroup]="packagemaster" (ngSubmit)="onSubmit()">
      <div class="form-container">
        <div class="form-half">
          <div class="form-group">
            <label>Package Name <span class="required">*</span></label>
            <input
              type="text"
              class="form-control"
              formControlName="packagename"
              placeholder="Enter package name"
            />
            <div
              *ngIf="packagemaster.get('packagename')?.touched && packagemaster.get('packagename')?.invalid"
              class="text-danger"
            >
              Package Name is Required
            </div>
          </div>

          <div class="form-group">
            <label>Symptoms Group <span class="required">*</span></label>
            <select class="form-control" formControlName="symptom_group">
              <option *ngFor="let symptomgroup of symptomGroup" [value]="symptomgroup._id">
                {{ symptomgroup.symptomGroups }}
              </option>
            </select>
            <div
              *ngIf="packagemaster.get('symptom_group')?.touched && packagemaster.get('symptom_group')?.invalid"
              class="text-danger"
            >
              Symptom Group is Required
            </div>
          </div>
        </div>

        <div class="form-half">
          <div class="form-group">
            <label>Medicines <span class="required">*</span></label>
            <div class="multi-select-container">
              <div class="selected-tags">
                <span *ngFor="let m of selectedMedicines" class="tag">
                  {{ m.medicine_name }}
                  <span class="remove" (click)="removeMedicine(m)">Ã—</span>
                </span>
                <input
                  type="text"
                  class="form-control"
                  placeholder="Select medicines"
                  [formControl]="medicineSearchControl"
                  (focus)="dropdownOpenMedicines = true"
                />
              </div>
              <div class="dropdown" *ngIf="dropdownOpenMedicines && filteredMedicines.length > 0">
                <div
                  *ngFor="let m of filteredMedicines"
                  (click)="selectMedicine(m)"
                  class="dropdown-option"
                  [class.selected]="isMedicineSelected(m)"
                  style="padding: 6px; cursor: pointer;"
                >
                  {{ m.medicine_name }}
                </div>
              </div>
            </div>
            <div
              *ngIf="packagemaster.get('medicines')?.touched && packagemaster.get('medicines')?.invalid"
              class="text-danger"
            >
              Medicines is Required
            </div>
          </div>

          <div class="form-group">
            <label>Medication Time <span class="required">*</span></label>
            <div formGroupName="checkbox">
              <label><input type="checkbox" formControlName="morning" /> Morning</label>
              <label><input type="checkbox" formControlName="noon" /> Afternoon</label>
              <label><input type="checkbox" formControlName="evening" /> Evening</label>
              <label><input type="checkbox" formControlName="night" /> Night</label>
            </div>
            <div
              *ngIf="packagemaster.get('checkbox')?.touched && packagemaster.get('checkbox')?.invalid"
              class="text-danger"
            >
              Medication Time is Required
            </div>
          </div>
        </div>
      </div>

      <div class="form-container">
        <div class="form-half">
          <div class="form-group">
            <label>Intake <span class="required">*</span></label>
            <input
              type="text"
              class="form-control"
              formControlName="intake"
              placeholder="e.g. After meals"
            />
            <div
              *ngIf="packagemaster.get('intake')?.touched && packagemaster.get('intake')?.invalid"
              class="text-danger"
            >
              Intake is Required
            </div>
          </div>
        </div>
        <div class="form-half">
          <div class="form-group">
            <label>Advice <span class="required">*</span></label>
            <input
              type="text"
              class="form-control"
              formControlName="advice"
              placeholder="Enter any advice"
            />
            <div
              *ngIf="packagemaster.get('advice')?.touched && packagemaster.get('advice')?.invalid"
              class="text-danger"
            >
              Advice is Required
            </div>
          </div>
        </div>
      </div>
      <div class="form-actions text-center mt-3">
        <button
          type="submit"
          class="btn btn-dark mx-2"
          [disabled]="packagemaster.invalid"
        >
          {{ editMode ? "UPDATE" : "SAVE" }}
        </button>
      </div>
    </form>
  </div>
</div>
