<div class="form-meta">
  <div class="header">
    <h2>INPATIENT PHARMACY REQUSITION LIST</h2>
    <div class="">
      <button class="list-cases-btn" [routerLink]="['/doctor/pharmareq']" routerLinkActive="router-link-active">
        ADD PHARMACY REQUSITION REQUEST
      </button>
    </div>
  </div>
  <!--
  <form [formGroup]="filterForm" class="top-bar p-3">
    <select formControlName="recordsPerPage">
      <option *ngFor="let num of [10, 25, 50, 100]" [value]="num">{{ num }} RECORDS</option>
    </select>
  
    <input type="text" placeholder="Search..." formControlName="searchText" />
  </form> -->
  
  <!-- Filter by Today or Date Range -->
  <div class="filters d-flex align-items-center m-3">
  
    <div class="form-group position-relative w-50">
      <input type="text" [(ngModel)]="searchText" (input)="applyFilters()" placeholder="Search by uhid/patient/mobile"
        class="form-control" />
    </div>
  
    <label class="m-3">
      <input type="radio" name="filter" value="today" [(ngModel)]="activeFilter" (change)="applyFilters()" checked />
      TODAY'S
    </label>
  
    <label class="m-3">
      <input type="radio" name="filter" value="dateRange" [(ngModel)]="activeFilter" (change)="applyFilters()" />
      Date Range
    </label>
  
    <!-- Date Inputs Visible Only for Date Range -->
    <input *ngIf="activeFilter === 'dateRange'" type="date" [(ngModel)]="startDate" (change)="applyFilters()"
      class="form-control mx-2" />
    <input *ngIf="activeFilter === 'dateRange'" type="date" [(ngModel)]="endDate" (change)="applyFilters()"
      class="form-control mx-2" />
  </div>
  
  <app-loader [patientData]="filteredCases" [title]="module" [activeFilter]="activeFilter" [startDate]="startDate"
    [endDate]="endDate"></app-loader>
  
  <div class="" *ngIf="userPermissions.read && filteredCases.length > 0">
    <table class="table table-bordered table-hover align-middle diagnosis-table">
      <thead class="table-dark text-center">
        <tr>
          <th>#</th>
          <th>Patient Name</th>
          <th>UHID</th>
          <th>Patient Type</th>
          <th>Requested Medicine</th>
          <th>Status</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody *ngIf="isMedicineMapLoaded">
        <tr *ngFor="let req of filteredCases; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ req.patient_name }}</td>
          <td>{{ req.uhid }}</td>
          <td>{{ req.patientType }}</td>
          <td>
            <ng-container *ngFor="let item of req.packages; let j = index">
              {{ medicineMap[item.medicineId] || item.medicineId }}
              - {{ item.quantity }}{{ j < req.packages.length - 1 ? ", " : "" }} </ng-container>
          </td>
          <td>{{ req.status }}</td>
          <td>
            <ng-container *ngIf="req.status !== 'completed'">
              <i class="fa-solid fa-pencil action-btn" *ngIf="userPermissions.update"
                (click)="editPharmaReq(req._id)"></i>
              <!-- <i
                class="fa-solid fa-trash action-btn"
                *ngIf="userPermissions.delete"
                (click)="deletePharmaReq(req._id)"
              ></i> -->
            </ng-container>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

</div>