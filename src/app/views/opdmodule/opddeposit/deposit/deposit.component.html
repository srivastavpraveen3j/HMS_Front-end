<!-- <p>deposit works!</p> -->

<div class="header">
  <h2>ADD NEW OPD DEPOSIT DATA</h2>
  <!-- <button class="list-cases-btn" [routerLink]="['/opd/depositlist']" routerLinkActive="router-link-active">DEPOSIT LIST</button> -->
  <span class="icons position-relative">
  <!-- <i class="fa-solid fa-user-tie mx-2" (click)="showUHIDDropdown = !showUHIDDropdown"></i> -->
  <i class="fa-solid fa-signal" [routerLink]="['/opd/depositlist']" routerLinkActive="router-link-active"></i>

  <!-- Dropdown -->
  <!-- <div *ngIf="showUHIDDropdown" class="dropdown-uhid-custom">
    <div *ngIf="uhidTodayRecords.length === 0" class="text-center text-muted py-2">
      No UHID created today.
    </div>

    <ul class="uhid-list">
      <li *ngFor="let record of uhidTodayRecords" (click)="selectPatientFromUHID(record)" style="cursor: pointer;">
  <div class="uhid-name">{{ record.patient_name }}</div>
  <div class="uhid-meta">UHID: {{ record.uhid }} | Age: {{ record.age }}</div>
</li>

    </ul>
  </div> -->
</span>
</div>

<div class="opd-container" *ngIf="userPermissions.create">
  <form [formGroup]="depositForm" (ngSubmit)="onSubmit()">
    <div class="form-half">

      <label>Bill No</label>
      <input type="text" class="form-control" placeholder="Caseno" formControlName="billnumber"/>
      <div *ngIf="depositForm.get('billnumber')?.invalid && depositForm.get('billnumber')?.touched" class="error-message">
        Bill No is required.
      </div>
      <!-- <label hidden>OPD Bill Id</label> -->
      <input type="text" class="form-control" placeholder="Caseno" formControlName="outpatientBillId" readonly  hidden />

      <!-- <label>Bill Amount</label>
      <input type="number" class="form-control" placeholder="Bill Amount" formControlName="billAmount" />
      <div *ngIf="depositForm.get('billAmount')?.invalid && depositForm.get('billAmount')?.touched" class="error-message">
        Bill Amount is required and must be a positive number.
      </div> -->

      <label>Amount Deposited</label>
      <input type="number" class="form-control" placeholder="Amount Deposited" formControlName="depositAmount" />
      <div *ngIf="depositForm.get('depositAmount')?.invalid && depositForm.get('depositAmount')?.touched" class="error-message">
        Amount Deposited is required and must be a positive number.
      </div>

      <label>Depositer Name</label>
      <input type="text" class="form-control" placeholder="Receiver Name" formControlName="depositorName" />
      <div *ngIf="depositForm.get('depositorName')?.invalid && depositForm.get('depositorName')?.touched" class="error-message">
        Depositer Name is required.
      </div>
<!--
      <label>Payment Mode</label>
      <div class="radio-group mx-3">
        <input type="radio" formControlName="depositPaymentMethod" value="cash" /> Cash
        <input type="radio" formControlName="depositPaymentMethod" value="upi" /> UPI
        <input type="radio" formControlName="depositPaymentMethod" value="card" /> Card
      </div>
      <div *ngIf="depositForm.get('depositPaymentMethod')?.invalid && depositForm.get('depositPaymentMethod')?.touched" class="error-message">
        Payment Mode is required.
      </div> -->
    </div>


           <div class="form-group">
  <label>Payment Method</label>
  <div class="radio-group mx-3">
    <label><input type="radio" formControlName="depositPaymentMethod" value="cash" /> CASH</label>
    <label><input type="radio" formControlName="depositPaymentMethod" value="upi" /> UPI</label>
    <label><input type="radio" formControlName="depositPaymentMethod" value="card" /> CARD</label>
  </div>
  <div *ngIf="depositForm.get('depositPaymentMethod')?.invalid && depositForm.get('depositPaymentMethod')?.touched" class="text-danger">
   Payment Mode is required.
  </div>
</div>

<!-- Show UPI Transaction ID input only if UPI is selected -->
<div class="form-group" *ngIf="depositForm.get('depositPaymentMethod')?.value === 'upi'">
  <label>Transaction ID</label>
  <input type="text" formControlName="transactionId" class="form-control" placeholder="Enter UPI Transaction ID" />
  <div *ngIf="depositForm.get('transactionId')?.invalid && depositForm.get('transactionId')?.touched" class="text-danger">
    Transaction ID is required
  </div>
</div>


    <div class="text-center mt-3">
      <button type="submit" class="btn btn-dark mx-2" [disabled]="depositForm.invalid">Submit</button>
      <button type="button" class="btn btn-secondary" >Cancel</button>
    </div>


  </form>

  <div class="right-section">



<!-- Tooltip with warning badge -->
    <div class="info-box">
      <h5 style="color: darkred;">Patient Detail</h5>
      <hr>

        <div *ngIf="statusMessage" class="alert alert-warning badge-warning tooltip-container ">
  {{ statusMessage }}
</div>
      <div class="" *ngFor=" let patient of patientdetails  ">

        <p>Uhid Number : {{patient.patientUhid?.uhid}}</p>
        <p>Patient Name : {{patient.patientUhid?.patient_name}}</p>
        <p>Gender : {{patient.patientUhid?.gender}}</p>
        <p>Age : {{patient.patientUhid?.age}}</p>
        <p>Dob : {{patient.patientUhid?.dob | date}}</p>
        <p>Mobile Number : {{patient.patientUhid?.mobile_no}}</p>
        <p>Deposit Amount : {{patient.depositId[0]?.depositAmount}}</p>
        <p>Total Amount : {{patient.totalamount}}</p>
        <p>Amount Paid : {{patient.amountreceived}}</p>
        <p>Amount Left : {{ patient.totalamount - ( patient.amountreceived + patient.depositId[0]?.depositAmount ) }}</p>
        <p>Payment Method : {{patient.paymentmethod}}</p>
      </div>
    </div>
  </div>
</div>
