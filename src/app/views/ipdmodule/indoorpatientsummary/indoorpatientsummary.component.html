<div class="form-meta my-3">
  <div class="container-fluid">
    <div class="header mb-2">
      <h3>Indoor Summary Chart</h3>
    </div>
    <div class="card shadow-sm mb-4">
      <div class="card-body pb-2">
        <form class="row gx-2 gy-2 align-items-end mb-2">
          <!-- Year -->
          <div class="col-md-2">
            <label class="form-label small mb-1">Year</label>
            <select
              class="form-select form-select-sm"
              [(ngModel)]="filters.year"
              name="year"
              (ngModelChange)="onMonthOrYearChange()"
            >
              <option *ngFor="let y of years" [ngValue]="y">{{ y }}</option>
            </select>
          </div>

          <!-- Month -->
          <div class="col-md-2">
            <label class="form-label small mb-1">Month</label>
            <select
              class="form-select form-select-sm"
              [(ngModel)]="filters.month"
              name="month"
              (ngModelChange)="onMonthOrYearChange()"
            >
              <option *ngFor="let m of months" [value]="m.value">
                {{ m.label }}
              </option>
            </select>
          </div>

          <!-- Date Range -->
          <div class="col-md-4">
            <label class="form-label small mb-1">Date Range</label>
            <div class="d-flex gap-2">
              <input
                type="date"
                class="form-control form-control-sm"
                [(ngModel)]="startDate"
                name="dateFrom"
                (change)="updateMonthYearFromDateRange()"
              />
              <span class="align-self-center">to</span>
              <input
                type="date"
                class="form-control form-control-sm"
                [(ngModel)]="endDate"
                name="dateTo"
                (change)="updateMonthYearFromDateRange()"
              />
            </div>
          </div>

          <div class="col-md-2">
            <label class="form-label small mb-1">UHID</label>
            <input
              type="text"
              placeholder="Filter by UHID"
              class="form-control form-control-sm"
              [(ngModel)]="filters.uhid"
              name="uhid"
              (input)="applyFilters()"
            />
          </div>

          <div class="col-md-2">
            <label class="form-label small mb-1">Patient Name</label>
            <input
              type="text"
              placeholder="Filter by patient name"
              class="form-control form-control-sm"
              [(ngModel)]="filters.name"
              name="name"
              (input)="applyFilters()"
            />
          </div>

          <div class="col-md-2">
            <label class="form-label small mb-1">IPD No</label>
            <input
              type="text"
              placeholder="Filter by IPD No"
              class="form-control form-control-sm"
              [(ngModel)]="filters.ipdNo"
              name="ipdNo"
              (input)="applyFilters()"
            />
          </div>

          <div class="col-md-2">
            <label class="form-label small mb-1">Bill No</label>
            <input
              type="text"
              placeholder="Filter by Bill No"
              class="form-control form-control-sm"
              [(ngModel)]="filters.billNo"
              name="billNo"
              (input)="applyFilters()"
            />
          </div>
        </form>
      </div>
    </div>

    <div class="shadow-sm mb-2">
      <div class="card-body p-2">
        <div class="table-responsive">
          <table
            class="table table-bordered table-hover table-sm align-middle mb-0"
          >
            <thead class="table-light">
              <tr>
                <th>#</th>
                <th>Indoor</th>
                <th>Patient</th>
                <th>Surgery</th>
                <th>Remark</th>
                <th>Uc Dr</th>
                <!-- <th>D.E.</th> -->
                <!-- <th>Rec OT</th> -->
                <!-- <th>D.C</th> -->
                <!-- <th>Bill No.</th> -->
                <th>DOD</th>
                <th>DOA</th>
                <th>MLC</th>
                <th>Cashless</th>
                <!-- <th>RecNo</th> -->
                <!-- <th>InvNo</th> -->
                <th>UHID</th>
                <th>Notes</th>
              </tr>
            </thead>
            <tbody>
              <tr
                *ngFor="let summary of indoorSummary; let i = index"
                [ngClass]="{ 'discharged-row': summary.isDischarge }"
              >
                <td>{{ i + 1 }}</td>
                <td>{{ summary.inpatientCaseNumber }}</td>
                <td (click)="viewsummary(summary)">
                  {{ summary.uniqueHealthIdentificationId?.patient_name }}
                </td>
                <td>{{ summary.surgery }}</td>
                <td>
                  {{
                    summary.patient_type === "cashless"
                      ? summary.companyName
                      : summary.patient_type
                  }}
                </td>
                <td>{{ summary.admittingDoctorId?.name }}</td>
                <!-- <td>{{ summary.billNo }}</td> -->
                <td>
                  {{
                    summary.isDischarge
                      ? (summary.dischargeDate | date: 'dd-MMM-yyyy hh:mm a')
                      : ""
                  }}
                </td>
                <td>{{ summary.admissionDate | date : "dd-MMM-yyyy" }} {{ summary.admissionTime | dateToIST }} </td>
                <td>{{ summary.isMedicoLegalcase ? "Yes" : "No" }}</td>
                <td>{{ summary.patient_type === "cashless" ? "Yes" : "No" }}</td>
                <td>{{ summary.uniqueHealthIdentificationId?.uhid }}</td>
                <td>{{ summary.notes }}</td>
              </tr>
            
              <tr *ngIf="indoorSummary.length === 0">
                <td colspan="17" class="text-center text-muted">
                  No data for selected filter.
                </td>
              </tr>
            </tbody>            
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
